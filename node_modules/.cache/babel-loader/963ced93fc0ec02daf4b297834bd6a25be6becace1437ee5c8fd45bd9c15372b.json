{"ast":null,"code":"import { mapState, mapMutations } from 'vuex';\nimport * as XLSX from 'xlsx';\nexport default {\n  name: 'BaoKaoDanView',\n  computed: {\n    ...mapState(['tablenamelist'])\n  },\n  methods: {\n    ...mapMutations(['deleteArchive']),\n    deleteArchive(name) {\n      this.deleteArchive(name);\n    },\n    exportToExcel(name) {\n      const archive = this.tablenamelist[name];\n      if (!archive || !archive.data || archive.data.length === 0) {\n        alert('没有数据可导出');\n        return;\n      }\n\n      // 创建工作簿\n      const wb = XLSX.utils.book_new();\n\n      // 将数据转换为工作表\n      const ws = XLSX.utils.json_to_sheet(archive.data);\n\n      // 添加工作表到工作簿\n      XLSX.utils.book_append_sheet(wb, ws, name);\n\n      // 导出 Excel 文件\n      XLSX.writeFile(wb, `${name}.xlsx`);\n    }\n  },\n  data() {\n    return {\n      columns: [{\n        title: '院校名称',\n        dataIndex: 'schoolName',\n        key: 'schoolName'\n      }, {\n        title: '专业名称',\n        dataIndex: 'majorName',\n        key: 'majorName'\n      }]\n    };\n  }\n};","map":{"version":3,"names":["mapState","mapMutations","XLSX","name","computed","methods","deleteArchive","exportToExcel","archive","tablenamelist","data","length","alert","wb","utils","book_new","ws","json_to_sheet","book_append_sheet","writeFile","columns","title","dataIndex","key"],"sources":["/Users/jiangxingnandecomputer/Desktop/sss/gao_kao_system/src/views/BaoKaoDanView.vue"],"sourcesContent":["<template>\n  <div>\n    <div>报考档案</div>\n    <div v-for=\"(archive, name) in tablenamelist\" :key=\"name\" style=\"margin-bottom: 24px;\">\n      <div style=\"display: flex; justify-content: space-between; align-items: center;\">\n        <h2>{{ name }}</h2>\n        <div>\n          <a-button type=\"primary\" @click=\"exportToExcel(name)\">导出为 Excel</a-button>\n          <a-button type=\"danger\" @click=\"deleteArchive(name)\">删除</a-button>\n        </div>\n      </div>\n      <a-table :dataSource=\"archive.data\" :columns=\"columns\" :pagination=\"false\" />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapMutations } from 'vuex';\nimport * as XLSX from 'xlsx';\n\nexport default {\n  name: 'BaoKaoDanView',\n  computed: {\n    ...mapState(['tablenamelist']),\n  },\n  methods: {\n    ...mapMutations(['deleteArchive']),\n    deleteArchive(name) {\n      this.deleteArchive(name);\n    },\n    exportToExcel(name) {\n      const archive = this.tablenamelist[name];\n      if (!archive || !archive.data || archive.data.length === 0) {\n        alert('没有数据可导出');\n        return;\n      }\n\n      // 创建工作簿\n      const wb = XLSX.utils.book_new();\n\n      // 将数据转换为工作表\n      const ws = XLSX.utils.json_to_sheet(archive.data);\n\n      // 添加工作表到工作簿\n      XLSX.utils.book_append_sheet(wb, ws, name);\n\n      // 导出 Excel 文件\n      XLSX.writeFile(wb, `${name}.xlsx`);\n    }\n  },\n  data() {\n    return {\n      columns: [\n        { title: '院校名称', dataIndex: 'schoolName', key: 'schoolName' },\n        { title: '专业名称', dataIndex: 'majorName', key: 'majorName' }\n      ]\n    };\n  }\n};\n</script>\n\n<style scoped>\n/* Add your styles here */\n</style>\n"],"mappings":"AAiBA,SAASA,QAAQ,EAAEC,YAAW,QAAS,MAAM;AAC7C,OAAO,KAAKC,IAAG,MAAO,MAAM;AAE5B,eAAe;EACbC,IAAI,EAAE,eAAe;EACrBC,QAAQ,EAAE;IACR,GAAGJ,QAAQ,CAAC,CAAC,eAAe,CAAC;EAC/B,CAAC;EACDK,OAAO,EAAE;IACP,GAAGJ,YAAY,CAAC,CAAC,eAAe,CAAC,CAAC;IAClCK,aAAaA,CAACH,IAAI,EAAE;MAClB,IAAI,CAACG,aAAa,CAACH,IAAI,CAAC;IAC1B,CAAC;IACDI,aAAaA,CAACJ,IAAI,EAAE;MAClB,MAAMK,OAAM,GAAI,IAAI,CAACC,aAAa,CAACN,IAAI,CAAC;MACxC,IAAI,CAACK,OAAM,IAAK,CAACA,OAAO,CAACE,IAAG,IAAKF,OAAO,CAACE,IAAI,CAACC,MAAK,KAAM,CAAC,EAAE;QAC1DC,KAAK,CAAC,SAAS,CAAC;QAChB;MACF;;MAEA;MACA,MAAMC,EAAC,GAAIX,IAAI,CAACY,KAAK,CAACC,QAAQ,CAAC,CAAC;;MAEhC;MACA,MAAMC,EAAC,GAAId,IAAI,CAACY,KAAK,CAACG,aAAa,CAACT,OAAO,CAACE,IAAI,CAAC;;MAEjD;MACAR,IAAI,CAACY,KAAK,CAACI,iBAAiB,CAACL,EAAE,EAAEG,EAAE,EAAEb,IAAI,CAAC;;MAE1C;MACAD,IAAI,CAACiB,SAAS,CAACN,EAAE,EAAE,GAAGV,IAAI,OAAO,CAAC;IACpC;EACF,CAAC;EACDO,IAAIA,CAAA,EAAG;IACL,OAAO;MACLU,OAAO,EAAE,CACP;QAAEC,KAAK,EAAE,MAAM;QAAEC,SAAS,EAAE,YAAY;QAAEC,GAAG,EAAE;MAAa,CAAC,EAC7D;QAAEF,KAAK,EAAE,MAAM;QAAEC,SAAS,EAAE,WAAW;QAAEC,GAAG,EAAE;MAAY;IAE9D,CAAC;EACH;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}