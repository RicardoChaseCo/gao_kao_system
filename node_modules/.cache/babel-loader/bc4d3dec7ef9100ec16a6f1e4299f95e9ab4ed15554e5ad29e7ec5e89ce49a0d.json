{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-7dbd18ba\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  style: {\n    \"display\": \"flex\",\n    \"justify-content\": \"space-between\",\n    \"align-items\": \"center\"\n  }\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_a_button = _resolveComponent(\"a-button\");\n  const _component_a_table = _resolveComponent(\"a-table\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.tablenamelist, (archive, name) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: name,\n      style: {\n        \"margin-bottom\": \"24px\"\n      }\n    }, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"h2\", null, _toDisplayString(name), 1 /* TEXT */), _createElementVNode(\"div\", null, [_createVNode(_component_a_button, {\n      type: \"primary\",\n      onClick: $event => $options.exportToExcel(name)\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"导出为 Excel\")]),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"]), _createVNode(_component_a_button, {\n      type: \"danger\",\n      onClick: $event => $options.handleDeleteArchive(name)\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"删除\")]),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])])]), _createVNode(_component_a_table, {\n      dataSource: archive.data,\n      columns: $data.columns,\n      pagination: false\n    }, null, 8 /* PROPS */, [\"dataSource\", \"columns\"])]);\n  }), 128 /* KEYED_FRAGMENT */))]);\n}","map":{"version":3,"names":["class","style","_createElementBlock","_hoisted_1","_Fragment","_renderList","_ctx","tablenamelist","archive","name","key","_createElementVNode","_hoisted_2","_toDisplayString","_createVNode","_component_a_button","type","onClick","$event","$options","exportToExcel","default","_withCtx","_createTextVNode","_","handleDeleteArchive","_component_a_table","dataSource","data","columns","$data","pagination"],"sources":["/Users/jiangxingnan/Desktop/gao_kao_system/src/views/BaoKaoDanView.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <div v-for=\"(archive, name) in tablenamelist\" :key=\"name\" style=\"margin-bottom: 24px;\">\n      <div style=\"display: flex; justify-content: space-between; align-items: center;\">\n        <h2>{{ name }}</h2>\n        <div>\n          <a-button type=\"primary\" @click=\"exportToExcel(name)\">导出为 Excel</a-button>\n          <a-button type=\"danger\" @click=\"handleDeleteArchive(name)\">删除</a-button>\n        </div>\n      </div>\n      <a-table :dataSource=\"archive.data\" :columns=\"columns\" :pagination=\"false\" />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapMutations } from 'vuex';\nimport * as XLSX from 'xlsx';\n\nexport default {\n  name: 'BaoKaoDanView',\n  computed: {\n    ...mapState(['tablenamelist']),\n  },\n  methods: {\n    ...mapMutations(['deleteArchive']),\n    handleDeleteArchive(name) {\n      this.deleteArchive(name);\n    },\n    exportToExcel(name) {\n      const archive = this.tablenamelist[name];\n      if (!archive || !archive.data || archive.data.length === 0) {\n        alert('没有数据可导出');\n        return;\n      }\n\n      // 创建工作簿\n      const wb = XLSX.utils.book_new();\n\n      // 将数据转换为工作表\n      const ws = XLSX.utils.json_to_sheet(archive.data);\n\n      // 添加工作表到工作簿\n      XLSX.utils.book_append_sheet(wb, ws, name);\n\n      // 导出 Excel 文件\n      XLSX.writeFile(wb, `${name}.xlsx`);\n    }\n  },\n  data() {\n    return {\n      columns: [\n        { title: '院校名称', dataIndex: 'schoolName', key: 'schoolName' },\n        { title: '专业名称', dataIndex: 'majorName', key: 'majorName' }\n      ]\n    };\n  }\n};\n</script>\n\n<style scoped>\n.container {\n  padding: 20px;\n  background-color: #ffffff;\n  min-height: 80vh;\n}\n</style>\n"],"mappings":";;;EACOA,KAAK,EAAC;AAAW;;EAEbC,KAA2E,EAA3E;IAAA;IAAA;IAAA;EAAA;AAA2E;;;;uBAFpFC,mBAAA,CAWM,OAXNC,UAWM,I,kBAVJD,mBAAA,CASME,SAAA,QAXVC,WAAA,CAEmCC,IAAA,CAAAC,aAAa,EAFhD,CAEiBC,OAAO,EAAEC,IAAI;yBAA1BP,mBAAA,CASM;MATyCQ,GAAG,EAAED,IAAI;MAAER,KAA4B,EAA5B;QAAA;MAAA;QACxDU,mBAAA,CAMM,OANNC,UAMM,GALJD,mBAAA,CAAmB,YAAAE,gBAAA,CAAZJ,IAAI,kBACXE,mBAAA,CAGM,cAFJG,YAAA,CAA0EC,mBAAA;MAAhEC,IAAI,EAAC,SAAS;MAAEC,OAAK,EAAAC,MAAA,IAAEC,QAAA,CAAAC,aAAa,CAACX,IAAI;;MAN7DY,OAAA,EAAAC,QAAA,CAMgE,MAAS,CANzEC,gBAAA,CAMgE,WAAS,E;MANzEC,CAAA;sDAOUV,YAAA,CAAwEC,mBAAA;MAA9DC,IAAI,EAAC,QAAQ;MAAEC,OAAK,EAAAC,MAAA,IAAEC,QAAA,CAAAM,mBAAmB,CAAChB,IAAI;;MAPlEY,OAAA,EAAAC,QAAA,CAOqE,MAAE,CAPvEC,gBAAA,CAOqE,IAAE,E;MAPvEC,CAAA;0DAUMV,YAAA,CAA6EY,kBAAA;MAAnEC,UAAU,EAAEnB,OAAO,CAACoB,IAAI;MAAGC,OAAO,EAAEC,KAAA,CAAAD,OAAO;MAAGE,UAAU,EAAE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}